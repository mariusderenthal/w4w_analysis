---
title: "W4W - Afforestation DAG"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## load packages 

```{r}
pacman::p_load(ggdag)
theme_set(theme_dag())
```
# Relationships between variables
## build DAG
```{r}
afforestation_dam <- dagify(affo ~ 
                              # Topography and soil conditions
                              slope + aspect +  ORCDRC  +
                              # Distance covariates
                              dist_pop + dist_river + dist_mill + dist_afforestation +
                              # Factors 
                              class + muni + dam_construction,
                            
                              # landcover class is influenced topography and soil conditions
                              class  ~ slope + aspect  + ORCDRC + dist_pop,
                            
                              # dist_river and class are moderated by dam construction period
                              dist_river  ~ dam_construction,
                              class   ~ dam_construction,

                         labels = c("affo" = "Afforestation", 
                                    "slope" = "Slope",
                                    "aspect" = "Aspect",
                                    "ORCDRC" = "Soil organic content",
                                    
                                    "dist_pop" = "Distance to city",
                                    "dist_river" = "Distance to river",
                                    "dist_mill" = "Distance to mill",
                                    "dist_afforestation" = "Distance nearest Afforestation",
                                    
                                    "class" = "Land cover class",
                                    "muni" = "Municipality",
                                    "dam_construction" = "Dam construction period"),
                                    
                         latent = "class",
                         exposure = "dam_construction",
                         outcome = "affo")

```

## plot DAG
```{r}
ggdag(afforestation_dam, text = FALSE, use_labels = "label")

```

## plot open paths and potential back-door path
```{r}
ggdag_paths(afforestation_dam, text = FALSE, use_labels = "label", shadow = TRUE)
```

## plot potential adjustments
```{r}
ggdag_adjustment_set(afforestation_dam, text = FALSE, use_labels = "label", shadow = TRUE)
```
 
# Colliders and collider-stratification bias
## plot d-seperation
```{r}
#ggdag_dseparated(from = "dist_river", to = "slope", controlling_for = "dam_construction",
#                text = FALSE, use_labels = "label")
```
 
# Mediation
## plot 

## comments
- "The DAG does not display an interaction. Thatâ€™s because DAGs do not specify how variables combine to influence other variables." McElreath 2020 p.240
